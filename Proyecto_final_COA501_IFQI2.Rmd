---
title: "Proyecto final"
author: "Iv치n F. Quiroz Ib치침ez"
date: "`r format(Sys.time(), '%d % de %B % de %Y')`"
output:
  beamer_presentation:
    theme: Madrid

---

```{r echo=FALSE, out.width='30%', out.height="40%",fig.show='hold',fig.align ='center'}
knitr::include_graphics('./logo_fitosanidad.png')
```

## R Markdown

This is an R Markdown presentation. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

## Contenido

- **0) Estudio de caso**
- **1) Base de datos y AED**
- **2) Random Forest**
- **3) Naive Bayes**
- **4) K-NN**
- **5) Curvas Receiver Operating Characteristic (ROC)**



## Slide with R Output


```{r,echo=FALSE}
#cargar base de datos
rm(list = ls())
base <- read.csv("ABCPE_MIXTO_B1_R_coordenadas.csv")
base$Arbol <- as.factor(base$Arbol)
base$Bloque <- as.factor(base$Bloque)
base$Anio <- as.factor(base$Anio)
base$Muestreo <- as.factor((base$Muestreo))
base$Fungicida<- as.factor((base$Fungicida))
base$Nutrimento <- as.factor((base$Nutrimento))
base$DDA <- as.factor((base$DDA))
base$trat <- as.factor((base$trat))
base$AltRan <- as.factor((base$AltRan))
```

## Slide with R Output

```{r, echo =TRUE, warning=FALSE, message=FALSE, out.width="60%", fig.show='hold',fig.align ='center',size=10}
#matriz de diagramas de dispersion
library(GGally)
ggpairs(base[,c(5,6,7,18,19,22,24,28:30)], 
        title="correlograma con ggpairs") 
```


## PCA

```{r, echo =FALSE, warning=FALSE, message=FALSE, out.width="30%",fig.align ='center', out=8}
base2<- na.omit(base[,c(14,2,5,6,7,18,19,22,24,28:30)])

#An치lisis de componentes principales 
pca <- prcomp(base2[,-c(1,2)], scale = T, center=T)
summary(pca)

#biplot
library(ggplot2)
  ggplot(base2, aes(x = pca$x[,2], y = pca$x[,1], 
  colour = as.factor(base2$Anio)))+
  geom_point(size=3) +
  ggtitle("PCA por Edad del follaje")

```



## Analisis de componentes princiales

```{r, echo =FALSE, warning=FALSE, message=FALSE, out.width="65%", fig.align ='center'}
par(mfrow = c(1,3))
plot(pca)
biplot(pca, main="PCA biplot")

colores <- function(vec){
  # la funci?n rainbow() devuelve un vector que contiene el n?mero de colores distintos
  col <- rainbow(length(unique(vec)))
  return(col[as.numeric(as.factor(vec))])
}

plot(pca$x[,c(1, 2)], col = colores(base$Bloque),
     pch = 19, 
     xlab = "PC1", 
     ylab = "PC2", main="PCA por Transparencia")
```

